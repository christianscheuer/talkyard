@**
 * Copyright (C) 2013-2017 Kaj Magnus Lindberg
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *@

@(tpi: debiki.SiteTpi, useGoogleAnalytics: Boolean = true)(content: Html)

@mustLoginToRead = @{ tpi.siteSettings.userMustBeAuthenticated }

<!DOCTYPE html>
<html class="@tpi.debikiHtmlTagClasses">
<head>
@tpi.debikiMeta
@if(tpi.anyEmbeddingUrl.nonEmpty) {
<base href="@{tpi.anyEmbeddingUrl.get}" target="_parent">
}
@Html(tpi.anySafeMetaTags)
@tpi.debikiStyles
@tpi.stylesheetBundle("styles.css")
@Html(tpi.siteSettings.headStylesHtml)
@tpi.debikiScriptsInHead()
@if(useGoogleAnalytics) {
@Html(tpi.anyGoogleUniversalAnalyticsScript)
}
</head>
<body>
<!-- wrapper.scala.html -->
<div id="esPageColumn">
<div id="esPageScrollable">
<div id="thePageTop"></div>
@{ /* UX; SHOULD show the header, if logged in. Solution = move this to Typescript. [7WKBAY02] */}
@if(!mustLoginToRead) {
<div class="esPageHeader">
@* Auto collapse nav menu items, if narrow screen?  https://github.com/lukejacksonn/GreedyNav  *@
@Html(tpi.siteSettings.headerHtml)
</div>
}

@content

@if(!tpi.anyCurrentPageRole.exists(_.isChat)) {
  @{ /* UX; SHOULD show footer, if logged in. Solution = move this to Typescript. [7WKBAY02] */}
  @if(!mustLoginToRead) {
    @Html(tpi.siteSettings.footerHtml)
  }
}

<div id="thePageBottom"></div>
</div>
</div>
<div id="theSidebarPageOverlay"></div>
<div id="esWatchbarColumn"></div>
<div id="esThisbarColumn"><div id="dw-any-sidebar"></div></div>

@tpi.debikiScriptsEndOfBody()
@Html(tpi.siteSettings.headScriptsHtml)
@tpi.anyScriptsBundle()
@Html(tpi.siteSettings.endOfBodyHtml)
</body>
</html>
